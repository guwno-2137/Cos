<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hologram mObywatel-style</title>
<style>
  body { background: #fff; margin:0; display:flex; align-items:center; justify-content:center; height:100vh; }
  #box { position: relative; width: 120px; height: 140px; } /* większy rozmiar do testów */
  canvas { width:100%; height:100%; display:block; }
  #godlo { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; image-rendering:optimizeQuality; }
</style>
</head>
<body>
  <div id="box">
    <canvas id="c"></canvas>
    <img id="godlo" src="godlo.svg" alt="godło"/>
  </div>
<script>
const colors = [
  "#ff9999", // blady czerwony
  "#ffff99", // blady żółty
  "#ccffcc", // blady jasno-zielony
  "#ccccff"  // blady fiolet
];

function lerp(a, b, t){
  const ar = parseInt(a.substr(1,2),16);
  const ag = parseInt(a.substr(3,2),16);
  const ab = parseInt(a.substr(5,2),16);
  const br = parseInt(b.substr(1,2),16);
  const bg = parseInt(b.substr(3,2),16);
  const bb = parseInt(b.substr(5,2),16);
  const rr = Math.round(ar + (br-ar)*t);
  const gg = Math.round(ag + (bg-ag)*t);
  const bb2 = Math.round(ab + (bb-ab)*t);
  return `rgb(${rr},${gg},${bb2})`;
}

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
function resize(){
  canvas.width = canvas.clientWidth * devicePixelRatio;
  canvas.height = canvas.clientHeight * devicePixelRatio;
  ctx.scale(devicePixelRatio, devicePixelRatio);
}
resize();
window.addEventListener("resize", resize);

function draw(angle){
  // map angle to 0..1
  const t = ((angle % 360) + 360) % 360 / 360;
  // cycle through 4 colors
  const idx = Math.floor(t * (colors.length));
  const nxt = (idx + 1) % colors.length;
  const frac = (t * colors.length) - idx;
  const col = lerp(colors[idx], colors[nxt], frac);

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // tło
  ctx.fillStyle = col;
  ctx.fillRect(0,0, canvas.clientWidth, canvas.clientHeight);

  // shimmer — prosty ślad światła
  const grd = ctx.createLinearGradient(0,0, canvas.clientWidth, canvas.clientHeight);
  grd.addColorStop(0, "rgba(255,255,255,0.2)");
  grd.addColorStop(0.5, "rgba(255,255,255,0)");
  grd.addColorStop(1, "rgba(255,255,255,0.2)");
  ctx.fillStyle = grd;
  ctx.fillRect(0,0, canvas.clientWidth, canvas.clientHeight);
}

let ang = 0;
function handler(e){
  const y = e.accelerationIncludingGravity?.y;
  const z = e.accelerationIncludingGravity?.z;
  if (typeof y === 'number' && typeof z === 'number'){
    ang = (Math.atan2(y,z) * 180 / Math.PI + 180) % 360;
    draw(ang);
  }
}

if (window.DeviceMotionEvent){
  window.addEventListener("devicemotion", handler);
} else {
  setInterval(()=>{
    ang = (ang + 1) % 360;
    draw(ang);
  }, 40);
}

draw(0);
</script>
</body>
</html>